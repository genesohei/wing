!function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();i(1);var n=u(i(3)),r=u(i(4)),a=u(i(5)),o=u(i(6));function u(e){return e&&e.__esModule?e:{default:e}}var h=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=new n.default,this.input=new r.default,this.game=new o.default(800,600,"game-content"),this.bullets=[],this.enemies=[],this.explosions=[],this.lastFire=Date.now(),this.isGameOver=0,this.terrainPattern=0,this.score=0,this.$score=null,this.$overlay=null,this.$over=null,this.$start=null,this.playerSpeed=200,this.bulletSpeed=500,this.enemySpeed=100}return s(e,[{key:"boot",value:function(){var e=this;this.terrainPattern=this.game.context.createPattern(this.resources.get("img/terrain.png"),"repeat"),this.$overlay=document.querySelector("#game-overlay"),this.$over=document.querySelector("#game-over"),this.$score=document.querySelector("#game-score"),this.$start=document.querySelector("#game-start"),this.$start.addEventListener("click",function(){e.reset()}),this.player={pos:[0,0],sprite:new a.default(this.resources,{url:"img/sprites.png",pos:[0,0],size:[39,39],speed:16,frames:[0,1]})},this.reset(),this.game.update=this.update.bind(this),this.game.render=this.render.bind(this),this.input.boot(),this.game.start()}},{key:"update",value:function(e){this.handleInput(e),this.updateEntities(e),this.needIncreaseDifficulty(this.game.time)&&this.enemies.push({pos:this.startingEnemyPosition(),sprite:new a.default(this.resources,{url:"img/sprites.png",pos:[0,78],size:[80,39],speed:6,frames:[0,1,2,3,2,1]})}),this.checkCollisions(),this.$score.innerHTML=this.score}},{key:"startingEnemyPosition",value:function(){return[this.game.canvas.width,Math.random()*(this.game.canvas.height-39)]}},{key:"needIncreaseDifficulty",value:function(e){return Math.random()<1-Math.pow(.993,e)}},{key:"handleInput",value:function(e){if((this.input.isDown("DOWN")||this.input.isDown("s"))&&(this.player.pos[1]+=this.playerSpeed*e),(this.input.isDown("UP")||this.input.isDown("w"))&&(this.player.pos[1]-=this.playerSpeed*e),(this.input.isDown("LEFT")||this.input.isDown("a"))&&(this.player.pos[0]-=this.playerSpeed*e),(this.input.isDown("RIGHT")||this.input.isDown("d"))&&(this.player.pos[0]+=this.playerSpeed*e),this.input.isDown("SPACE")&&!this.isGameOver&&Date.now()-this.lastFire>100){var t=this.player.pos[0]+this.player.sprite.size[0]/2,i=this.player.pos[1]+this.player.sprite.size[1]/2;this.bullets.push({pos:[t,i],dir:"forward",sprite:new a.default(this.resources,{url:"img/sprites.png",pos:[0,39],size:[18,8]})}),this.bullets.push({pos:[t,i],dir:"up",sprite:new a.default(this.resources,{url:"img/sprites.png",pos:[0,50],size:[9,5]})}),this.bullets.push({pos:[t,i],dir:"down",sprite:new a.default(this.resources,{url:"img/sprites.png",pos:[0,60],size:[9,5]})}),this.lastFire=Date.now()}}},{key:"updateEntities",value:function(e){this.player.sprite.update(e);for(var t=0;t<this.bullets.length;t++){var i=this.bullets[t];switch(i.dir){case"up":i.pos[1]-=this.bulletSpeed*e;break;case"down":i.pos[1]+=this.bulletSpeed*e;break;default:i.pos[0]+=this.bulletSpeed*e}(i.pos[1]<0||i.pos[1]>this.game.canvas.height||i.pos[0]>this.game.canvas.width)&&(this.bullets.splice(t,1),t--)}for(var s=0;s<this.enemies.length;s++)this.enemies[s].pos[0]-=this.enemySpeed*e,this.enemies[s].sprite.update(e),this.enemies[s].pos[0]+this.enemies[s].sprite.size[0]<0&&(this.enemies.splice(s,1),s--);for(var n=0;n<this.explosions.length;n++)this.explosions[n].sprite.update(e),this.explosions[n].sprite.done&&(this.explosions.splice(n,1),n--)}},{key:"collides",value:function(e,t,i,s,n,r,a,o){return!(i<=n||e>a||s<=r||t>o)}},{key:"boxCollides",value:function(e,t,i,s){return this.collides(e[0],e[1],e[0]+t[0],e[1]+t[1],i[0],i[1],i[0]+s[0],i[1]+s[1])}},{key:"checkCollisions",value:function(){this.checkPlayerBounds();for(var e=0;e<this.enemies.length;e++){for(var t=this.enemies[e].pos,i=this.enemies[e].sprite.size,s=0;s<this.bullets.length;s++){var n=this.bullets[s].pos,r=this.bullets[s].sprite.size;if(this.boxCollides(t,i,n,r)){this.enemies.splice(e,1),e--,this.score+=100,this.explosions.push({pos:t,sprite:new a.default(this.resources,{url:"img/sprites.png",pos:[0,117],size:[39,39],speed:16,frames:[0,1,2,3,4,5,6,7,8,9,10,11,12],dir:null,once:!0})}),this.bullets.splice(s,1);break}}this.boxCollides(t,i,this.player.pos,this.player.sprite.size)&&this.gameOver()}}},{key:"checkPlayerBounds",value:function(){this.player.pos[0]<0?this.player.pos[0]=0:this.player.pos[0]>this.game.canvas.width-this.player.sprite.size[0]&&(this.player.pos[0]=this.game.canvas.width-this.player.sprite.size[0]),this.player.pos[1]<0?this.player.pos[1]=0:this.player.pos[1]>this.game.canvas.height-this.player.sprite.size[1]&&(this.player.pos[1]=this.game.canvas.height-this.player.sprite.size[1])}},{key:"render",value:function(){this.game.context.fillStyle=this.terrainPattern,this.game.context.fillRect(0,0,this.game.canvas.width,this.game.canvas.height),this.isGameOver||this.renderEntity(this.player),this.renderEntities(this.bullets),this.renderEntities(this.enemies),this.renderEntities(this.explosions)}},{key:"renderEntities",value:function(e){for(var t=0;t<e.length;t++)this.renderEntity(e[t])}},{key:"renderEntity",value:function(e){this.game.context.save(),this.game.context.translate(e.pos[0],e.pos[1]),e.sprite.render(this.game.context),this.game.context.restore()}},{key:"gameOver",value:function(){this.$over.style.display="block",this.$overlay.style.display="block",this.isGameOver=!0}},{key:"reset",value:function(){this.$over.style.display="none",this.$overlay.style.display="none",this.game.resetTime(),this.isGameOver=!1,this.score=0,this.enemies=[],this.bullets=[],this.player.pos=[50,this.game.canvas.height/2]}}]),e}());h.resources.load(["img/sprites.png","img/terrain.png"]),h.resources.onReady(h.boot.bind(h))},function(e,t,i){},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resourceCache={},this.loading=[],this.readyCallbacks=[]}return s(e,[{key:"load",value:function(e){var t=this;e instanceof Array?e.forEach(function(e){t._load(e)}):this._load(e)}},{key:"_load",value:function(e){var t=this;if(this.resourceCache[e])return this.resourceCache[e];var i=new Image;i.onload=function(){t.resourceCache[e]=i,t.isReady()&&t.readyCallbacks.forEach(function(e){e()})},this.resourceCache[e]=!1,i.src=e}},{key:"get",value:function(e){return this.resourceCache[e]}},{key:"isReady",value:function(){var e=!0;for(var t in this.resourceCache)this.resourceCache.hasOwnProperty(t)&&!this.resourceCache[t]&&(e=!1);return e}},{key:"onReady",value:function(e){this.readyCallbacks.push(e)}}]),e}();t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pressedKeys={}}return s(e,[{key:"boot",value:function(){var e=this;document.addEventListener("keydown",function(t){e.setKey(t,!0)}),document.addEventListener("keyup",function(t){e.setKey(t,!1)}),window.addEventListener("blur",function(){e.pressedKeys={}})}},{key:"setKey",value:function(e,t){var i=e.keyCode,s=void 0;switch(i){case 32:s="SPACE";break;case 37:s="LEFT";break;case 38:s="UP";break;case 39:s="RIGHT";break;case 40:s="DOWN";break;default:s=String.fromCharCode(i)}this.pressedKeys[s]=t}},{key:"isDown",value:function(e){return this.pressedKeys[e.toUpperCase()]}}]),e}();t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=t,this.url=i.url,this.pos=i.pos,this.size=i.size,this.speed="number"==typeof i.speed?i.speed:0,this.frames=i.frames,this.dir=i.dir||"horizontal",this.once=i.once,this._index=0}return s(e,[{key:"update",value:function(e){this._index+=this.speed*e}},{key:"render",value:function(e){var t=void 0;if(this.speed>0){var i=this.frames.length,s=Math.floor(this._index);if(t=this.frames[s%i],this.once&&s>=i)return void(this.done=!0)}else t=0;var n=this.pos[0],r=this.pos[1];"vertical"===this.dir?r+=t*this.size[1]:n+=t*this.size[0],e.drawImage(this.resources.get(this.url),n,r,this.size[0],this.size[1],0,0,this.size[0],this.size[1])}}]),e}();t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();var r=function(){function e(t,i,n,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=800,this.height=600,this.parent="",this.update=null,this.render=null,this.canvas=null,this.context=null,this.time=0,this.lastTime=Date.now(),this.now=0,this.deltaTime=0;for(var o=["ms","moz","webkit","o"],u=0;u<o.length&&!window.requestAnimationFrame;u++)window.requestAnimationFrame=window[o[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[o[u]+"CancelAnimationFrame"]||window[o[u]+"CancelRequestAnimationFrame"];1===arguments.length&&"object"===s(arguments[0])?this.parseConfig(arguments[0]):(t&&(this.width=t),i&&(this.height=i),n&&(this.parent=n)),this.createCanvas(),this.addToDOM()}return n(e,[{key:"parseConfig",value:function(e){e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.parent&&(this.parent=e.parent)}},{key:"createCanvas",value:function(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height}},{key:"addToDOM",value:function(){var e=document.getElementById(this.parent)||document.body;e&&e.appendChild(this.canvas)}},{key:"animate",value:function(){this.now=Date.now(),this.deltaTime=(this.now-this.lastTime)/1e3,this.time+=this.deltaTime,this.lastTime=this.now,this.update(this.deltaTime),this.render()}},{key:"start",value:function(){var e=this;this.isRunning=!0,window.requestAnimationFrame?(this.isSetTimeOut=!1,this._onLoop=function(t){return e.updateRAF(t)},this.timeOutID=window.requestAnimationFrame(this._onLoop)):(this.isSetTimeOut=!0,this._onLoop=function(){return e.updateSetTimeout()},this.timeOutID=window.setTimeout(this._onLoop,0))}},{key:"updateRAF",value:function(){this.isRunning&&(this.animate(),this.timeOutID=window.requestAnimationFrame(this._onLoop))}},{key:"updateSetTimeout",value:function(){this.isRunning&&(this.animate(),this.timeOutID=window.setTimeout(this._onLoop))}},{key:"stop",value:function(){this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID),this.isRunning=!1}},{key:"resetTime",value:function(){this.time=0}}]),e}();t.default=r}]);